<!DOCTYPE html>
<html>

<head>
    <title>View Recipes</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'interactions/css/rating.css' %}">
</head>

<body>
    <h1>Recipes</h1>
    <ul>
        {% for recipe in recipes %}
        <li>
            <h2>Title: {{ recipe.recipe_name }}</h2>
            <p>Total Time: {{ recipe.total_time }}</p>
            <p>Dish Type: {{ recipe.dishType }}</p>
            <p>Description: {{ recipe.description }}</p>
            <p>Instruction: {{ recipe.instruction }}</p>
            {% if recipe.photo_video %}
            <img src="{{ recipe.photo_video.url }}" alt="{{ recipe.recipe_name }}">
            {% endif %}

            <!-- Edit button -->
            <form method="get" action="{% url 'edit_recipe' recipe.id %}">
                <button type="submit">Edit</button>
            </form>

            <!-- Include delete recipe HTML -->
            {% include 'recipes/delete_recipe.html' %}
            <!-- Display existing comments and ratings -->
            <div class="ratings-comments">
                <h3>Ratings and Comments:</h3>
                {% for rating in recipe.ratings.all %}
                <div class="rating">
                    <p>Rating: {{ rating.rating }} / 5</p>
                    <p>Comment: {{ rating.comment }}</p>
                    <p>By: {{ rating.user.username }}</p>
                    <p>At: {{ rating.created_at }}</p>
                    {% if rating.user == request.user %}
                    <a href="{% url 'edit_rating_and_comment' recipe.id rating.id %}">Edit</a>
                    {% endif %}
                </div>
                {% empty %}
                {% include 'interactions/rate_post.html' %}
                {% endfor %}
            </div>

        </li>
        {% endfor %}
    </ul>

</body>

</html>